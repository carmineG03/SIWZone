<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prodotti Simili - SIWZone</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/headerFooter.css" rel="stylesheet" type="text/css">
    <link href="/css/stileIndex.css" rel="stylesheet" type="text/css">
    <link href="/css/dettaglioProdotto.css" rel="stylesheet" type="text/css">
</head>
<body>
    <!-- Navbar -->
    <div class="navbar" id="navbar">
        <div class="nav-links">
            <a href="/">Home</a>
            <a href="/showAllProdotti">Prodotti</a>
            <a th:if="${userDetails != null and userDetails.authorities.?[authority == 'ADMIN'].size() > 0}" href="/admin/success">Area Riservata</a>
        </div>

        <div class="search-bar">
            <form th:action="@{/ricercaProdotti}" method="POST">
                <input type="text" name="keyword" th:value="${keyword}" placeholder="Cerca prodotti...">
                <button type="submit">Cerca</button>
            </form>
        </div>

        <div th:if="${userDetails}" class="auth-links">
            <span th:text="${userDetails.username}"></span>
            <a href="/logout">Logout</a>
        </div>
        <div th:unless="${userDetails}" class="auth-links">
            <a href="/login">Login</a>
            <a href="/register">Registrazione</a>
        </div>
        <span class="menu-icon" onclick="toggleMenu()">&#9776;</span>
    </div>

    <!-- Contenuto principale -->
    <div class="product-detail">
        <a th:href="@{/prodotto/{id}(id=${prodotto.id})}" class="back-button">
            <i class="fas fa-arrow-left"></i> Torna al Prodotto
        </a>
        
        <!-- Info prodotto principale -->
        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 30px; border-left: 4px solid #007bff;">
            <h2 style="margin: 0; color: #333;">
                <i class="fas fa-link"></i> Prodotti Simili a: <span th:text="${prodotto.nome}">Nome Prodotto</span>
            </h2>
            <p style="margin: 10px 0 0 0; color: #666;">
                Scopri altri prodotti che potrebbero interessarti
            </p>
        </div>

        <!-- Griglia prodotti simili -->
        <div th:if="${prodottiSimili != null and !prodottiSimili.isEmpty()}">
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px;">
                <div th:each="simile : ${prodottiSimili}" 
                     style="background: white; border-radius: 15px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: transform 0.3s; cursor: pointer;"
                     th:onclick="'window.location.href=\'/prodotto/\' + ' + ${simile.id}">
                    
                    <!-- Immagine prodotto -->
                    <div style="text-align: center; margin-bottom: 15px;">
                        <img th:if="${!simile.immagini.isEmpty()}" 
                             th:src="@{/prodotto/immagine/{iid}(iid=${simile.immagini[0].id})}" 
                             th:alt="${simile.nome}"
                             style="width: 100%; max-width: 200px; height: 200px; object-fit: cover; border-radius: 10px;" />
                        <img th:if="${simile.immagini.isEmpty()}" 
                             src="/images/placeholder.png" 
                             alt="Nessuna immagine"
                             style="width: 100%; max-width: 200px; height: 200px; object-fit: cover; border-radius: 10px;" />
                    </div>
                    
                    <!-- Info prodotto -->
                    <h3 style="margin: 0 0 10px 0; color: #333; font-size: 1.2rem;" th:text="${simile.nome}">Nome</h3>
                    
                    <div style="margin-bottom: 10px;">
                        <span style="background: #3498db; color: white; padding: 5px 10px; border-radius: 15px; font-size: 0.8rem;" 
                              th:text="${simile.tipologia}">Categoria</span>
                    </div>
                    
                    <p style="color: #666; font-size: 0.9rem; margin-bottom: 15px; height: 40px; overflow: hidden;" 
                       th:text="${simile.descrizione != null ? (simile.descrizione.length() > 60 ? simile.descrizione.substring(0, 60) + '...' : simile.descrizione) : 'Nessuna descrizione'}">
                        Descrizione
                    </p>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="font-size: 1.3rem; color: #e74c3c; font-weight: bold;">
                            EUR <span th:text="${simile.prezzo}">0.00</span>
                        </span>
                        <a th:href="@{/prodotto/{id}(id=${simile.id})}" 
                           style="background: #28a745; color: white; padding: 8px 15px; text-decoration: none; border-radius: 5px; font-size: 0.9rem;">
                            <i class="fas fa-eye"></i> Dettagli
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Messaggio quando non ci sono prodotti simili -->
        <div th:if="${prodottiSimili == null or prodottiSimili.isEmpty()}" 
             style="text-align: center; padding: 60px; color: #666;">
            <i class="fas fa-search" style="font-size: 4rem; margin-bottom: 20px; color: #ccc;"></i>
            <h3>Nessun prodotto simile trovato</h3>
            <p>Non abbiamo ancora associato prodotti simili a questo articolo.</p>
            <a href="/showAllProdotti" style="background: #007bff; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; margin-top: 20px; display: inline-block;">
                <i class="fas fa-shopping-bag"></i> Esplora tutti i prodotti
            </a>
        </div>
    </div>

    <script>
        function toggleMenu() {
            var navbar = document.getElementById('navbar');
            navbar.classList.toggle('responsive');
        }
        
        // Effetto hover per le card
        document.addEventListener('DOMContentLoaded', function() {
            const cards = document.querySelectorAll('[style*="cursor: pointer"]');
            cards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-5px)';
                });
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                });
            });
        });
    </script>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>SIWZone</h3>
                <p>La tua destinazione per prodotti di qualit√†. Scopri la nostra vasta gamma di articoli selezionati.</p>
            </div>
            <div class="footer-section">
                <h3>Link Utili</h3>
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/showAllProdotti">Prodotti</a></li>
                    <li><a href="/prodotti/categoria/Giardinaggio">Giardinaggio</a></li>
                    <li><a href="/prodotti/categoria/Elettronica">Elettronica</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 SIWZone. Tutti i diritti riservati.</p>
        </div>
    </footer>
</body>
</html>